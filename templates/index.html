<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Share Bot - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            color: #8892b0;
            font-size: 1.1rem;
        }
        
        .status-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .status-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .status-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .status-card-title {
            font-size: 0.9rem;
            color: #8892b0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 14px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .status-online {
            background: rgba(0, 255, 136, 0.15);
            color: #00ff88;
        }
        
        .status-offline {
            background: rgba(255, 71, 87, 0.15);
            color: #ff4757;
        }
        
        .pulse {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .pulse-green {
            background: #00ff88;
            box-shadow: 0 0 10px #00ff88;
        }
        
        .pulse-red {
            background: #ff4757;
            box-shadow: 0 0 10px #ff4757;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }
        
        .status-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .status-label {
            color: #8892b0;
            font-size: 0.9rem;
        }
        
        .api-key-section {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .api-key-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .api-key-name {
            font-size: 0.85rem;
            color: #ccd6f6;
        }
        
        .api-key-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
        }
        
        .connected {
            color: #00ff88;
        }
        
        .disconnected {
            color: #ff4757;
        }
        
        .check-icon, .x-icon {
            width: 16px;
            height: 16px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(0, 217, 255, 0.3);
        }
        
        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-label {
            color: #8892b0;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .uptime-display {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .time-block {
            text-align: center;
            min-width: 70px;
        }
        
        .time-value {
            font-size: 2rem;
            font-weight: 700;
            color: #00d9ff;
        }
        
        .time-label {
            font-size: 0.75rem;
            color: #8892b0;
            text-transform: uppercase;
        }
        
        .info-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .info-section h2 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #ccd6f6;
        }
        
        .how-to-use {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #00d9ff, #00ff88);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            color: #1a1a2e;
            flex-shrink: 0;
        }
        
        .step-text {
            font-size: 0.9rem;
            color: #ccd6f6;
            line-height: 1.5;
        }
        
        .endpoints {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        .endpoint-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(0, 217, 255, 0.1);
            color: #00d9ff;
            text-decoration: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            border: 1px solid rgba(0, 217, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .endpoint-btn:hover {
            background: rgba(0, 217, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .bot-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            background: linear-gradient(135deg, #0088cc, #00a6ed);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 15px;
        }
        
        .bot-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 136, 204, 0.4);
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #5a6a8a;
            font-size: 0.85rem;
        }
        
        .refresh-time {
            text-align: center;
            color: #5a6a8a;
            font-size: 0.8rem;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .time-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>File Share Bot Dashboard</h1>
            <p>Real-time monitoring and status</p>
        </div>
        
        <div class="status-section">
            <div class="status-card">
                <div class="status-card-header">
                    <span class="status-card-title">Bot Status</span>
                    <div class="status-indicator status-online" id="bot-status">
                        <span class="pulse pulse-green"></span>
                        <span id="bot-status-text">Running</span>
                    </div>
                </div>
                <div class="status-value" id="bot-username">@loading...</div>
                <div class="status-label">Bot Username</div>
            </div>
            
            <div class="status-card">
                <div class="status-card-header">
                    <span class="status-card-title">Running Time</span>
                </div>
                <div class="uptime-display" id="uptime-display">
                    <div class="time-block">
                        <div class="time-value" id="days">00</div>
                        <div class="time-label">Days</div>
                    </div>
                    <div class="time-block">
                        <div class="time-value" id="hours">00</div>
                        <div class="time-label">Hours</div>
                    </div>
                    <div class="time-block">
                        <div class="time-value" id="minutes">00</div>
                        <div class="time-label">Minutes</div>
                    </div>
                    <div class="time-block">
                        <div class="time-value" id="seconds">00</div>
                        <div class="time-label">Seconds</div>
                    </div>
                </div>
            </div>
            
            <div class="status-card">
                <div class="status-card-header">
                    <span class="status-card-title">API Keys Status</span>
                </div>
                <div class="api-key-section">
                    <div class="api-key-item">
                        <span class="api-key-name">TELEGRAM_API_ID</span>
                        <span class="api-key-status connected" id="api-id-status">
                            <svg class="check-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>
                            Connected
                        </span>
                    </div>
                    <div class="api-key-item">
                        <span class="api-key-name">TELEGRAM_API_HASH</span>
                        <span class="api-key-status connected" id="api-hash-status">
                            <svg class="check-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>
                            Connected
                        </span>
                    </div>
                    <div class="api-key-item">
                        <span class="api-key-name">BOT_TOKEN</span>
                        <span class="api-key-status connected" id="bot-token-status">
                            <svg class="check-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>
                            Connected
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üìÅ</div>
                <div class="stat-number" id="total-files">0</div>
                <div class="stat-label">Files Stored</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-number" id="total-users">0</div>
                <div class="stat-label">Total Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üîÑ</div>
                <div class="stat-number" id="health-status">OK</div>
                <div class="stat-label">Health Status</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üåê</div>
                <div class="stat-number">8000</div>
                <div class="stat-label">Server Port</div>
            </div>
        </div>
        
        <div class="info-section">
            <h2>How to Use</h2>
            <div class="how-to-use">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-text">Open Telegram and search for the bot</div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-text">Send /start command to begin</div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-text">Upload any file (up to 4GB)</div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-text">Get permanent share link instantly</div>
                </div>
            </div>
            <a href="#" class="bot-link" id="telegram-link">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/></svg>
                Open Bot in Telegram
            </a>
        </div>
        
        <div class="info-section">
            <h2>API Endpoints</h2>
            <div class="endpoints">
                <a href="/health" class="endpoint-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    Health Check
                </a>
                <a href="/stats" class="endpoint-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
                    Statistics
                </a>
                <a href="/status" class="endpoint-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    Status
                </a>
                <a href="/dashboard" class="endpoint-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
                    Dashboard
                </a>
            </div>
        </div>
        
        <div class="refresh-time">
            Last updated: <span id="last-update">Loading...</span> | Auto-refresh every 5 seconds
        </div>
        
        <div class="footer">
            File Share Bot Dashboard | Powered by Pyrogram
        </div>
    </div>
    
    <script>
        let uptimeSeconds = 0;
        
        async function fetchStats() {
            try {
                const response = await fetch('/stats');
                const data = await response.json();
                
                document.getElementById('bot-username').textContent = '@' + (data.bot_username || 'unknown');
                document.getElementById('total-files').textContent = data.total_files || 0;
                document.getElementById('total-users').textContent = data.total_users || 0;
                uptimeSeconds = Math.floor(data.uptime || 0);
                
                const telegramLink = document.getElementById('telegram-link');
                if (data.bot_username) {
                    telegramLink.href = 'https://t.me/' + data.bot_username;
                }
                
                updateApiStatus(data);
                updateUptime();
                
            } catch (error) {
                console.error('Error fetching stats:', error);
            }
        }
        
        async function fetchHealth() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                
                const statusIndicator = document.getElementById('bot-status');
                const statusText = document.getElementById('bot-status-text');
                const healthStatus = document.getElementById('health-status');
                
                if (data.status === 'healthy' && data.bot === 'online') {
                    statusIndicator.className = 'status-indicator status-online';
                    statusIndicator.innerHTML = '<span class="pulse pulse-green"></span><span>Running</span>';
                    healthStatus.textContent = 'OK';
                } else {
                    statusIndicator.className = 'status-indicator status-offline';
                    statusIndicator.innerHTML = '<span class="pulse pulse-red"></span><span>Offline</span>';
                    healthStatus.textContent = 'Error';
                }
                
            } catch (error) {
                const statusIndicator = document.getElementById('bot-status');
                statusIndicator.className = 'status-indicator status-offline';
                statusIndicator.innerHTML = '<span class="pulse pulse-red"></span><span>Offline</span>';
                document.getElementById('health-status').textContent = 'Error';
            }
        }
        
        function updateApiStatus(data) {
            const apiIdStatus = document.getElementById('api-id-status');
            const apiHashStatus = document.getElementById('api-hash-status');
            const botTokenStatus = document.getElementById('bot-token-status');
            
            const connectedHtml = '<svg class="check-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg> Connected';
            const disconnectedHtml = '<svg class="x-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> Disconnected';
            
            if (data.api_id_connected) {
                apiIdStatus.className = 'api-key-status connected';
                apiIdStatus.innerHTML = connectedHtml;
            } else {
                apiIdStatus.className = 'api-key-status disconnected';
                apiIdStatus.innerHTML = disconnectedHtml;
            }
            
            if (data.api_hash_connected) {
                apiHashStatus.className = 'api-key-status connected';
                apiHashStatus.innerHTML = connectedHtml;
            } else {
                apiHashStatus.className = 'api-key-status disconnected';
                apiHashStatus.innerHTML = disconnectedHtml;
            }
            
            if (data.bot_token_connected) {
                botTokenStatus.className = 'api-key-status connected';
                botTokenStatus.innerHTML = connectedHtml;
            } else {
                botTokenStatus.className = 'api-key-status disconnected';
                botTokenStatus.innerHTML = disconnectedHtml;
            }
        }
        
        function updateUptime() {
            const days = Math.floor(uptimeSeconds / 86400);
            const hours = Math.floor((uptimeSeconds % 86400) / 3600);
            const minutes = Math.floor((uptimeSeconds % 3600) / 60);
            const seconds = uptimeSeconds % 60;
            
            document.getElementById('days').textContent = String(days).padStart(2, '0');
            document.getElementById('hours').textContent = String(hours).padStart(2, '0');
            document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
            document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            
            uptimeSeconds++;
        }
        
        function updateLastUpdate() {
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleTimeString();
        }
        
        fetchStats();
        fetchHealth();
        updateLastUpdate();
        
        setInterval(updateUptime, 1000);
        
        setInterval(() => {
            fetchStats();
            fetchHealth();
            updateLastUpdate();
        }, 5000);
    </script>
</body>
</html>
